{{- if .enable -}}
<section id="features" class="features relative py-8 xl:py-32 overflow-hidden" {{ if eq site.Language.LanguageDirection "rtl" }}dir="rtl"{{ end }}>
    <!-- Background decorations -->
    <div class="absolute top-20 {{ if eq site.Language.LanguageDirection "rtl" }}left-0{{ else }}right-0{{ end }} w-72 h-72 bg-primary/5 rounded-full filter blur-3xl -z-10"></div>
    <div class="absolute bottom-20 {{ if eq site.Language.LanguageDirection "rtl" }}right-0{{ else }}left-0{{ end }} w-72 h-72 bg-tertiary/5 rounded-full filter blur-3xl -z-10"></div>

    <div class="container mx-auto px-4">
        <h2
            class="feature-title-premium xl:max-w-2/3 mx-auto text-center text-[#252525] font-semibold text-4xl xl:text-5xl leading-tight mb-6 scroll-animate">
            {{ i18n "features_title" | safeHTML }}
        </h2>
        <p class="feature-text-premium xl:max-w-2xl mx-auto text-center text-[#868686] text-lg mb-16 scroll-animate"
            style="animation-delay: 0.2s;">
            {{ i18n "features_text" }}
        </p>
    </div>

    <div class="flex flex-col relative gap-20">
        {{/* Define feature items with i18n keys */}}
        {{ $featureItems := slice
            (dict "icon" "fas fa-code" "color" "#496BC1" "pretitleKey" "feature_1_pretitle" "pretextKey" "feature_1_pretext" "titleKey" "feature_1_title" "textKey" "feature_1_text" "image" "https://images.unsplash.com/photo-1498050108023-c5249f4df085?w=800&h=600&fit=crop")
            (dict "icon" "fas fa-mobile-screen" "color" "#FBCD37" "pretitleKey" "feature_2_pretitle" "pretextKey" "feature_2_pretext" "titleKey" "feature_2_title" "textKey" "feature_2_text" "image" "https://images.unsplash.com/photo-1512941937669-90a1b58e7e9c?w=800&h=600&fit=crop")
            (dict "icon" "fas fa-lightbulb" "color" "#496BC1" "pretitleKey" "feature_3_pretitle" "pretextKey" "feature_3_pretext" "titleKey" "feature_3_title" "textKey" "feature_3_text" "image" "https://images.unsplash.com/photo-1460925895917-afdab827c52f?w=800&h=600&fit=crop")
        }}
        {{- range $index, $item := $featureItems -}}
        <div class="container mx-auto px-4 {{ if (mod $index 2) }}scroll-animate-left{{ else }}scroll-animate-right{{ end }}"
            style="animation-delay: {{ mul $index 0.2 }}s;">
            <div class="grid xl:grid-cols-12 gap-8 xl:gap-12 items-center">

                <!-- Text Content - Always First on Mobile -->
                <div
                    class="xl:col-span-5 flex flex-col justify-center gap-6 order-1 {{ if (mod $index 2) }}xl:order-1{{ else }}xl:order-1{{ end }}">
                    <div class="flex flex-col xl:flex-row items-center xl:items-start justify-start gap-4">
                        <div
                            class="feature-icon-premium flex items-center justify-center shrink-0 text-xl text-white bg-[{{ $item.color }}] size-16 rounded-2xl shadow-lg magnetic-button">
                            <i class="{{ $item.icon }}"></i>
                        </div>
                        <div class="inline-flex flex-col text-center xl:text-start {{ if eq site.Language.LanguageDirection "rtl" }}xl:text-end{{ end }}">
                            <h2 class="feature-pretitle text-lg font-semibold text-stroke">{{ i18n $item.pretitleKey }}</h2>
                            <p class="text-sm text-[#868686]">{{ i18n $item.pretextKey }}</p>
                        </div>
                    </div>
                    <h3
                        class="feature-title-premium text-[#252525] font-bold text-3xl xl:text-4xl leading-tight text-center xl:text-start {{ if eq site.Language.LanguageDirection "rtl" }}xl:text-end{{ end }}">
                        {{ i18n $item.titleKey | markdownify }}
                    </h3>
                    <p
                        class="feature-text-premium text-[#545454] text-base xl:text-lg leading-relaxed text-center xl:text-start {{ if eq site.Language.LanguageDirection "rtl" }}xl:text-end{{ end }}">
                        {{ i18n $item.textKey }}
                    </p>
                </div>

                <!-- Image - Always Second on Mobile, Alternates on Desktop -->
                <div
                    class="xl:col-span-7 flex items-center justify-center order-2 {{ if (mod $index 2) }}xl:order-2{{ else }}xl:order-1{{ end }}">
                    <div class="feature-image-wrapper relative group">
                        <!-- Premium multi-layer glow -->
                        <div class="feature-glow-layer"></div>

                        <!-- Corner accents -->
                        <div class="feature-corner-accent top-left"></div>
                        <div class="feature-corner-accent bottom-right"></div>

                        <!-- Image container with overlay -->
                        <div class="feature-image-container relative overflow-hidden rounded-2xl">
                            {{ $class := "feature-image-premium w-[85%] xl:w-[75%] mx-auto" }}
                            {{ partial "responsive-img.html" (dict "src" $item.image "alt" (i18n $item.titleKey) "class" $class) }}
                            <!-- Gradient overlay on hover -->
                            <div class="feature-overlay-gradient"></div>

                            <!-- Floating particles -->
                            <div class="feature-particles"></div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
        {{- end -}}
    </div>
</section>
{{- end -}}