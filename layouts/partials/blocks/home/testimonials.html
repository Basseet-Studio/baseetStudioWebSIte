{{- $testimonials := site.Data.home.testimonials -}}
{{- if and $testimonials.enable $testimonials.items -}}

<section id="testimonials" class="testimonials-section relative py-16 xl:py-24 overflow-hidden bg-white">
  <!-- Background decorations -->
  <div class="absolute top-0 right-0 w-96 h-96 bg-primary/5 rounded-full filter blur-3xl -z-10"></div>
  <div class="absolute bottom-0 left-0 w-72 h-72 bg-tertiary/5 rounded-full filter blur-3xl -z-10"></div>

  <div class="container mx-auto px-4">
    <!-- Section Header -->
    <div class="text-center mb-12">
      <span class="glass-badge mb-4 scroll-animate">
        <i class="fas fa-star text-tertiary"></i>
        Testimonials
      </span>
      <h2 class="text-3xl xl:text-4xl font-bold text-[#171D1C] mb-4 scroll-animate" style="animation-delay: 0.1s;">
        {{ $testimonials.title | default "What Our Clients Say" }}
      </h2>
      <p class="text-lg text-[#545454] max-w-2xl mx-auto scroll-animate" style="animation-delay: 0.2s;">
        {{ $testimonials.subtitle | default "Real feedback from the people we work with" }}
      </p>
    </div>
  </div>

  <!-- Testimonials Carousel -->
  <div class="testimonials-carousel-wrapper">
    <div class="testimonials-carousel">
      <!-- First set of testimonials -->
      {{- range $testimonials.items -}}
      <div class="testimonial-slide">
        <div class="glass-card glass-glow p-6 h-full flex flex-col">
          <!-- Stars -->
          <div class="flex gap-1 mb-4">
            {{- range seq .rating -}}
            <i class="fas fa-star text-tertiary text-sm"></i>
            {{- end -}}
          </div>

          <!-- Quote -->
          <p class="text-[#545454] leading-relaxed mb-6 flex-grow italic">"{{ .quote }}"</p>

          <!-- Author -->
          <div class="flex items-center gap-3 mt-auto">
            <img src="{{ .avatar }}" alt="{{ .author }}"
              class="w-12 h-12 rounded-full object-cover border-2 border-white/80">
            <div>
              <div class="font-semibold text-[#171D1C] text-sm">{{ .author }}</div>
              <div class="text-xs text-[#868686]">{{ .role }}, {{ .company }}</div>
            </div>
          </div>
        </div>
      </div>
      {{- end -}}

      <!-- Duplicate set for seamless loop -->
      {{- range $testimonials.items -}}
      <div class="testimonial-slide">
        <div class="glass-card glass-glow p-6 h-full flex flex-col">
          <!-- Stars -->
          <div class="flex gap-1 mb-4">
            {{- range seq .rating -}}
            <i class="fas fa-star text-tertiary text-sm"></i>
            {{- end -}}
          </div>

          <!-- Quote -->
          <p class="text-[#545454] leading-relaxed mb-6 flex-grow italic">"{{ .quote }}"</p>

          <!-- Author -->
          <div class="flex items-center gap-3 mt-auto">
            <img src="{{ .avatar }}" alt="{{ .author }}"
              class="w-12 h-12 rounded-full object-cover border-2 border-white/80">
            <div>
              <div class="font-semibold text-[#171D1C] text-sm">{{ .author }}</div>
              <div class="text-xs text-[#868686]">{{ .role }}, {{ .company }}</div>
            </div>
          </div>
        </div>
      </div>
      {{- end -}}
    </div>
  </div>
</section>

<style>
  .testimonials-carousel-wrapper {
    width: 100%;
    overflow: hidden;
    mask-image: linear-gradient(to right, transparent, black 5%, black 95%, transparent);
    -webkit-mask-image: linear-gradient(to right, transparent, black 5%, black 95%, transparent);
  }

  .testimonials-carousel {
    display: flex;
    gap: 1.5rem;
    animation: testimonials-scroll 40s linear infinite;
    width: max-content;
  }

  .testimonials-carousel:hover {
    animation-play-state: paused;
  }

  .testimonial-slide {
    flex-shrink: 0;
    width: 350px;
    min-height: 220px;
  }

  @keyframes testimonials-scroll {
    0% {
      transform: translateX(0);
    }

    100% {
      transform: translateX(-50%);
    }
  }

  @media (max-width: 768px) {
    .testimonial-slide {
      width: 300px;
    }
  }
</style>

{{- end -}}