<!-- Skip to content for keyboard users -->
<a href="#mainContent" class="skip-to-content">{{ i18n "skip_to_content" }}</a>

<header id="app-bar" class="app-bar" role="banner" {{ if eq .Site.Language.LanguageDirection "rtl" }}dir="rtl"{{ end }}>
    <div class="app-bar-container">
        <!-- Logo -->
        <a href="{{ "/" | relLangURL }}" class="app-bar-logo logo-premium" aria-label="{{ i18n "aria_home_link" }}">
            <span class="logo-text">{{ i18n "logo_text" }}</span>
        </a>

        <!-- Desktop Navigation -->
        <nav class="app-bar-nav" aria-label="Main navigation">
            <ul class="nav-links">
                {{ range site.Menus.main }}
                <li><a href="{{ .URL | relLangURL }}" class="nav-link-premium {{ if eq .Name "Pricing" }}font-bold{{ end }}">{{ .Name }}</a></li>
                {{ end }}
            </ul>
            
            <!-- Language Switcher (Desktop) -->
            {{ partial "language-switcher.html" . }}
        </nav>

        <!-- Mobile Controls -->
        <div class="mobile-controls">
            <!-- Mobile Language Switcher -->
            <div class="mobile-language-switcher">
                {{ range .Site.Home.AllTranslations }}
                <a href="{{ .RelPermalink }}" 
                   class="mobile-lang-btn {{ if eq $.Site.Language.Lang .Language.Lang }}active{{ end }}"
                   lang="{{ .Language.Lang }}"
                   title="{{ .Language.LanguageName }}">
                    {{ if eq .Language.Lang "ar" }}Ø¹{{ else }}EN{{ end }}
                </a>
                {{ end }}
            </div>
            
            <!-- Mobile Menu Toggle -->
            <button class="mobile-menu-toggle" id="shared-mobile-toggle" aria-label="{{ i18n "aria_toggle_menu" }}" aria-expanded="false">
                <span class="hamburger-icon">
                    <span></span>
                    <span></span>
                    <span></span>
                </span>
            </button>
        </div>
    </div>
</header>

<!-- Mobile Menu Sidebar -->
<div id="shared-mobile-backdrop" class="mobile-menu-backdrop"></div>
<nav id="shared-mobile-menu" class="mobile-menu" aria-label="Mobile navigation" aria-hidden="true" data-lang="{{ .Site.Language.Lang }}">
    <ul class="mobile-nav-links">
        {{ range site.Menus.main }}
        <li><a href="{{ .URL | relLangURL }}" class="mobile-nav-link">{{ .Name }}</a></li>
        {{ end }}
    </ul>
</nav>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Shared header mobile menu
    const toggle = document.getElementById('shared-mobile-toggle');
    const menu = document.getElementById('shared-mobile-menu');
    const backdrop = document.getElementById('shared-mobile-backdrop');

    if (!toggle || !menu || !backdrop) return;

    function openMenu() {
        menu.classList.add('open');
        backdrop.classList.add('open');
        toggle.setAttribute('aria-expanded', 'true');
        document.body.classList.add('mobile-menu-open');
    }

    function closeMenu() {
        menu.classList.remove('open');
        backdrop.classList.remove('open');
        toggle.setAttribute('aria-expanded', 'false');
        document.body.classList.remove('mobile-menu-open');
    }

    toggle.addEventListener('click', function(e) {
        e.preventDefault();
        if (menu.classList.contains('open')) {
            closeMenu();
        } else {
            openMenu();
        }
    });

    backdrop.addEventListener('click', closeMenu);

    menu.querySelectorAll('a').forEach(function(link) {
        link.addEventListener('click', closeMenu);
    });
});
</script>
